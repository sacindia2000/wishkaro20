<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tab.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../../bower_components/polymer/lib/mixins/gesture-event-listeners.html">

<!-- Non polymer includes -->
<link rel="import" href="sharedstyles.html">
<link rel="import" href="my-firebaseinit.html">
<link rel="import" href="my-view.html">

<!-- Non polymer includes -->

<dom-module id="wishkaro20-app">
  <template>
    <style include = "sharedstyles">
      :host{
        top:0px;
      }
    </style>
    <app-header reveals slot="header">
      <app-toolbar style="height: 48px;">
          <div main-title style = "margin-left: 16px;margin-top:16px; margin-bottom:14px;" >WISH KARO</div>
      </app-toolbar>
      <paper-tabs  id = "mytabs" selected="{{tabselect}}" >
          <paper-tab> POPULAR </paper-tab>
          <paper-tab> CATEGORIES </paper-tab>
      </paper-tabs> 
    </app-header>
    <myfirebase-init config="{{_config}}" status = "{{firebaseinitstatus}}"></myfirebase-init>
    <iron-pages selected="{{tabselect}}">
      <my-view1 dbready = "{{firebasedbready}}"></my-view1>
      <my-view2 dbready = "{{firebasedbready}}"></my-view2>
    </iron-pages>
    
    </template>

  <script>
    /**
     * @customElement
     * @polymer
     */
    class Wishkaro20App extends Polymer.GestureEventListeners (Polymer.Element) {
      static get is() { return 'wishkaro20-app'; }
      static get properties() {
        return {
          prop1: {
            type: String,
            value: 'wishkaro20-app'
          },
 /** Add var for every observer to track first init **/  
          _observerinit:
          {
              type:Object,
              value:"`null"
          },
         /* Pass the Firebase Configuration Parameters */ 
          _config: 
          {
            type:Object,
          },
          /* Check the status of firebase init */
          firebaseinitstatus:
          {
            type: String,
            value:"None",
            observer : "firaebaseInitStatus"
          },
          /* Indicate whether data base is ready */
          firebasedbready:
          {
            type:Boolean,
            value:false,
            notify:true
          },
          /** For test only **/
          tabselect:
          {
            type: String,
            value:"0"
          }
        }
      } /** Properties */
      /**
     * @construct
     * polymer
     * When component lifecycle gets called, set the init 
     */
      constructor ()
      {
        Polymer.setPassiveTouchGestures(true);
        super();
         this._observerinit = 
           {
            firaebaseInitStatus : "none"
          
          }
      
      }
      /**
     * @Ready
     * polymer
     * When component lifecycle gets called, set the init 
     */
      ready( )
          {
            super.ready();
            this._config = 
             {
                          apiKey: "AIzaSyCZA25rLvj5sFwmn_gcE7pHZU1ABPZB3zc",
                          authDomain: "wishkaro-94738.firebaseapp.com",
                          databaseURL: "https://wishkaro-94738.firebaseio.com",
                          projectId: "wishkaro-94738",
                          storageBucket: "wishkaro-94738.appspot.com",
                          messagingSenderId: "710301933949"
                         };
          }
      /**
     * @firaebaseInitStatus
     * polymer
     * Observer to check the init status  
     */
      firaebaseInitStatus ( )
      {
         if(this._observerinit.firaebaseInitStatus === "ready")
         {
             console.log("Firebase Init" + this.firebaseinitstatus);
             this.firebasedbready = true;
         }else
         this._observerinit.firaebaseInitStatus = "ready";
      }


     }

    window.customElements.define(Wishkaro20App.is, Wishkaro20App);
  </script>
</dom-module>
