<html><head><link rel="import" href="../../bower_components/polymer/polymer-element.html"><link rel="import" href="../../bower_components/iron-list/iron-list.html"><link rel="import" href="../../bower_components/iron-image/iron-image.html"><link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html"><link rel="import" href="sharedstyles.html"><link rel="import" href="my-firestoreinit.html"><link rel="import" href="my-firestorequery.html"></head><body><dom-module id="my-view2"><template><style include="sharedstyles">:host{top:92px;}</style><my-firestoreinit firestoreconfig="{{dbconfig}}" firestorelistsize="{{listsize}}" firestorecollectionhndl="{{dbhandle}}"></my-firestoreinit><my-firestorequery firestorereadconfig="{{dbreadconfig}}" firestorefetchdata="{{reqdata}}" firestoredataobject="{{dataobject}}"></my-firestorequery><div class="container" on-click="handleClick"><iron-list items="[[imagearray]]" as="item" id="itemlist" scroll-target="document" selection-enabled="" selected-item="{{selectedItem}}" grid=""><template><div class="flexchild" style="width:calc(50% - .5px);"><iron-image class="imagecontainer" sizing="cover" style="width:calc(100% - 4px); height:180px; background-color: lightgray;" preload="" fade="" src="[[item.webp]]"></iron-image></div></template></iron-list></div></template><script>class MyView2 extends Polymer.Element{static get is(){return"my-view2"}static get properties(){return{prop1:{type:String,value:"my-view2"},dbreadconfig:{type:Object,value:"null",notify:!0},reqdata:{type:Boolean,value:!1,notify:!0},dataobject:{type:Object,value:"null",observer:"processData"},dbready:{type:Boolean,value:!1,observer:"databaseReady"},dbconfig:{type:Object,value:"null",notify:!0},listsize:{type:Number,value:0,observer:"DatabaseSize"},dbhandle:{type:Object,value:"null"},imagearray:{type:Array},_viewstate:{type:Object,value:"null"}}}constructor(){super();this._observerinit={dbready:"none",dataobject:"none",listsize:"none"};this._viewstate={newlistsize:0,listsize:0,currentpage:0,itemsperpage:4,numberofitems:0};this.imagearray=[]}ready(){super.ready()}loadMoreData(){console.log("Lucky Lucky")}databaseReady(){if("ready"===this._observerinit.dbready){console.log("Data base is ready");this.dbconfig={collection:"category",orderby:"sequence"}}else this._observerinit.dbready="ready"}requestData(){this.reqdata=!this.reqdata}processData(){if("ready"===this._observerinit.dataobject){console.log("Process the received data"+this.dataobject.get("sequence"));var imageobject={};imageobject.webp=this.dataobject.get("webp");this.push("imagearray",imageobject);this._viewstate.numberofitems++}else this._observerinit.dataobject="ready"}gotdatachanged(){console.log("gotdata changed View1"+this.gotdata.sequence)}handleClick(){console.log("I am clicked");this.getNextPage()}DatabaseSize(){if("ready"===this._observerinit.listsize){console.log("List Size "+this.listsize);if(0===this._viewstate.listsize){console.log("List size receive for the first tiem");console.log("DB Handle is "+this.dbhandle);this.dbreadconfig={limit:4,index:0,orderby:"sequence"};this.dbreadconfig.dbhandle=this.dbhandle;this.dbreadconfig.index=this.listsize;this._viewstate.listsize=this.listsize;this.getNextPage()}else this._viewstate.newlistsize=this._viewstate.listsize}else this._observerinit.listsize="ready"}getNextPage(){this.dbreadconfig.index=this._viewstate.listsize-this._viewstate.numberofitems;if(this._viewstate.listsize!=this._viewstate.numberofitems){this.requestData()}else console.log("List Complete")}}window.customElements.define(MyView2.is,MyView2);</script></dom-module></body></html>