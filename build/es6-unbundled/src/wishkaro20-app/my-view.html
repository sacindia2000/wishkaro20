<html><head><link rel="import" href="../../bower_components/polymer/polymer-element.html"><link rel="import" href="../../bower_components/iron-list/iron-list.html"><link rel="import" href="../../bower_components/iron-image/iron-image.html"><link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html"><link rel="import" href="../../bower_components/polymer/lib/mixins/gesture-event-listeners.html"><link rel="import" href="sharedstyles.html"><link rel="import" href="my-view1.html"><link rel="import" href="my-view2.html"></head><body><dom-module id="my-view"><template><style include="sharedstyles">.page1{position:absolute;width:100vw;margin-left:2px;margin-right:4px;}.page2{position:absolute;width:100vw;left:calc(100%);margin-left:4px;margin-right:2px;}</style><my-view1 id="view1" class="page1" dbready="{{dbready}}" style$="[[view1string]]"></my-view1><my-view2 id="view2" class="page2" dbready="{{dbready}}" style$="[[view2string]]"></my-view2></template><script>var test=30,_canceltimer;class MyView extends Polymer.GestureEventListeners(Polymer.Element){static get is(){return"my-view"}static get properties(){return{prop1:{type:String,value:"my-view"},dbreadconfig:{type:Object,value:"null",notify:!0},reqdata:{type:Boolean,value:!1,notify:!0},dataobject:{type:Object,value:"null",observer:"processData"},dbready:{type:Boolean,value:!1,observer:"databaseReady"},dbconfig:{type:Object,value:"null",notify:!0},listsize:{type:Number,value:0,observer:"DatabaseSize"},dbhandle:{type:Object,value:"null"},imagearray:{type:Array},_viewstate:{type:Object,value:"null"},view1left:{type:Number,value:0},view2left:{type:Number,value:360},view1string:{type:String,value:"touch-action:auto"}}}constructor(){super();this._observerinit={dbready:"none",dataobject:"none",listsize:"none"};this._viewstate={newlistsize:0,listsize:0,currentpage:0,itemsperpage:4,numberofitems:0};this.imagearray=[]}ready(){super.ready();console.log("My view is READY");Polymer.Gestures.addListener(this.$.view1,"track",e=>this.handleTrackView1(e));Polymer.Gestures.addListener(this.$.view2,"track",e=>this.handleTrackView2(e))}loadMoreData(){console.log("Lucky Lucky")}databaseReady(){if("ready"===this._observerinit.dbready){console.log("Data base is ready");this.dbconfig={collection:"popular",orderby:"sequence"}}else this._observerinit.dbready="ready"}requestData(){this.reqdata=!this.reqdata}processData(){if("ready"===this._observerinit.dataobject){console.log("Process the received data"+this.dataobject.get("sequence"));var imageobject={};imageobject.webp=this.dataobject.get("webp");imageobject.jpg=this.dataobject.get("jpg");this.push("imagearray",imageobject);this._viewstate.numberofitems++}else this._observerinit.dataobject="ready"}gotdatachanged(){console.log("gotdata changed View1"+this.gotdata.sequence)}handleClick(){console.log("I am clicked");this.getNextPage()}DatabaseSize(){if("ready"===this._observerinit.listsize){console.log("List Size "+this.listsize);if(0===this._viewstate.listsize){console.log("List size receive for the first tiem");console.log("DB Handle is "+this.dbhandle);this.dbreadconfig={limit:4,index:0,orderby:"sequence"};this.dbreadconfig.dbhandle=this.dbhandle;this.dbreadconfig.index=this.listsize;this._viewstate.listsize=this.listsize;this.getNextPage()}else this._viewstate.newlistsize=this._viewstate.listsize}else this._observerinit.listsize="ready"}getNextPage(){this.dbreadconfig.index=this._viewstate.listsize-this._viewstate.numberofitems;if(this._viewstate.listsize!=this._viewstate.numberofitems){this.requestData()}else console.log("List Complete")}handleTrackView1(evt){switch(evt.detail.state){case"start":console.log("P1 started");console.log("dx"+evt.detail.dx+"dy"+evt.detail.dy);this.view1left=evt.detail.dx;this.view2left=window.innerWidth+evt.detail.dx;this.view1string="left:"+this.view1left+"px";this.view2string="left:"+this.view2left+"px";break;case"track":console.log("X position"+evt.detail.x);console.log("dx position"+evt.detail.dx);console.log("dx"+evt.detail.dx+"dy"+evt.detail.dy);this.view1left=evt.detail.dx;this.view2left=window.innerWidth+evt.detail.dx;this.view1string="left:"+this.view1left+"px";this.view2string="left:"+this.view2left+"px";break;case"end":console.log("X position"+evt.detail.x);console.log("dx position"+evt.detail.dx);return;this.view1left=0;this.view2left=360;console.log("View1"+this.view1string+"View2"+this.view2string);break;}evt.preventDefault()}page2animateslide(){this.view1left=this.view1left+1;this.view2left=this.view2left+1;this.view1string="left:"+this.view1left+"px";this.view2string="left:"+this.view2left+"px";if(0<=this.view1left){this.view1left=0;this.view2left=360;this.view1string="left:"+this.view1left+"px";this.view2string="left:"+this.view2left+"px";window.clearInterval(_canceltimer)}}handleTrackView2(){}}window.customElements.define(MyView.is,MyView);</script></dom-module></body></html>