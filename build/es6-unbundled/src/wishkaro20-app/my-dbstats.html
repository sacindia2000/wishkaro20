<html><head><link rel="import" href="../../bower_components/polymer/polymer-element.html"><link rel="import" href="sharedstyles.html"><link rel="import" href="my-firestoreinit.html"></head><body><dom-module id="my-dbstats"><template><my-firestoreinit firestoreconfig="{{basedbconfig}}" firestoredataobject="{{basedbdataobject}}" firestorelistsize="{{basedbsize}}"></my-firestoreinit><dom-repeat items="[[categoryarray]]" as="item" mutable-data=""><template><my-firestoreinit dataupdatetoggle="{{categorysizechangeind}}" firestoreconfig="{{item.config}}" firestorelistsize="{{item.listsize}}" firestorecollectionhndl="{{item.dbhandlle}}"></my-firestoreinit></template></dom-repeat></template><script>var templistsize;class MyDbStats extends Polymer.MutableData(Polymer.Element){static get is(){return"my-dbstats"}static get properties(){return{dbready:{type:Boolean,value:!1,observer:"databaseReady"},basedbconfig:{type:Object,value:function(){return{collection:"null",orderby:"null",limit:0}},notify:!0},basedbsize:{type:Number,value:-1,observer:"categoryListSize"},basedbhandle:{type:Object,value:function(){return{}}},basedbreadconfig:{type:Object,value:function(){return{limit:30,index:0,orderby:"sequence",dbhandle:{}}}},basedbdataobject:{type:Object,value:function(){return null},observer:"collectionListObjectUpdatedCallback"},categorysizechangeind:{type:Boolean,value:!1,observer:"listSizeUpdated"},categoryarray:{type:Array,value:function(){return[]}},categoryarrayuisnapshot:{type:Array,value:function(){return[]},notify:!0},updateui:{type:Boolean,value:!1,notify:!0},_categorylistreadstate:{type:String,value:"Init"}}}ready(){super.ready();console.log("my-dbstats is READY")}databaseReady(){if(!0===this.dbready){console.log("Firebase Init done");this.basedbconfig.limit=30;this.basedbconfig.orderby="sequence";this.set("basedbconfig.collection","wishkaro")}}categoryListSize(){if(0<this.basedbsize){templistsize=this.basedbsize;console.log("Database updated list size"+this.basedbsize)}}collectionListObjectUpdatedCallback(){var collectionobject;if(null===this.basedbdataobject)return;console.log("Collection data received");if("Init"===this._categorylistreadstate){console.log("List updated reset count ");this.categoryarray.length=0;this._categorylistreadstate="Reading"}collectionobject=this.getCollectionObject();this.updateCollectionObject(collectionobject);this.push("categoryarray",collectionobject);console.log(collectionobject.icon+collectionobject.name);this.basedbsize--;if(0===this.basedbsize){this.updateUiSnapshot();this._categorylistreadstate="Init"}}listSizeUpdated(){console.log("List data updated inform UI");this.updateUiSnapshot()}getCollectionObject(){var temp={};temp.config={};temp.config.orderby="sequence";temp.config.limit=30;temp.listsize=0;temp.dbhandle={};return temp}updateCollectionObject(object){object.config.collection=this.basedbdataobject.get("name");object.icon=this.basedbdataobject.get("icon");object.title=this.basedbdataobject.get("title");object.urlsubstring=this.basedbdataobject.get("urlsubstring")}updateUiSnapshot(){this.categoryarrayuisnapshot.length=0;for(var i=0,uiobj;i<this.categoryarray.length;i++){uiobj={};uiobj.collection=this.categoryarray[i].config.collection;uiobj.listsize=this.categoryarray[i].listsize;uiobj.title=this.categoryarray[i].title;uiobj.urlsubstring=this.categoryarray[i].urlsubstring;uiobj.icon=this.categoryarray[i].icon;this.push("categoryarrayuisnapshot",uiobj)}this.updateui=!this.updateui}}window.customElements.define(MyDbStats.is,MyDbStats);</script></dom-module></body></html>