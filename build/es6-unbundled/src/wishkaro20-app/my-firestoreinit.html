<html><head><link rel="import" href="../../bower_components/polymer/polymer-element.html"><script src="wishkaro20global.js"></script></head><body><dom-module id="my-firestoreinit"><template></template><script>class MyFirestoreInit extends Polymer.Element{static get is(){return"my-firestoreinit"}static get properties(){return{prop1:{type:String,value:"firestore-init"},firestoreconfig:{type:Object,value:"null"},firestorecollectionhndl:{type:Object,value:"null",notify:!0},firestorelistsize:{type:Number,value:0,notify:!0},firestoreerror:{type:String,value:"null",notify:!0}}}static get observers(){return["configFirestore(firestoreconfig.collection)"]}constructor(){super();this._observerinit={configFirestore:"none"}}ready(){super.ready()}configFirestore(){if("ready"===this._observerinit.configFirestore){this.initfirestore(this.firestoreconfig.collection);this.getFirestoreListSize()}else this._observerinit.configFirestore="ready"}initfirestore(collection){if(0===myglobal.firestorehandle){myglobal.firestorehandle=firebase.firestore()}this.firestorecollectionhndl=myglobal.firestorehandle.collection(collection);console.log("Got connection handle for collection"+collection+"Handle"+this.firestorecollectionhndl)}getFirestoreListSize(){myglobal.firestorehandle.collection(this.firestoreconfig.collection).orderBy(this.firestoreconfig.orderby,"desc").limit(1).onSnapshot(function(querySnapshot){querySnapshot.forEach(function(doc){console.log(" List Size: "+doc.get("sequence"));this.firestorelistsize=doc.get("sequence")}.bind(this))}.bind(this))}}window.customElements.define(MyFirestoreInit.is,MyFirestoreInit);</script></dom-module></body></html>