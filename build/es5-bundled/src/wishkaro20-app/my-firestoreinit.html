<html><head></head><body><div hidden="" by-polymer-bundler=""><script>var myglobal={firebasehandle:0,firestorehandle:0},greadstate={INIT:"INIT",DBINIT:"DBINIT",READING:"READING"};</script></div><dom-module id="my-firestoreinit"><template></template><script>var readlistsize=0,MyFirestoreInit=function(_Polymer$Element){babelHelpers.inherits(MyFirestoreInit,_Polymer$Element);babelHelpers.createClass(MyFirestoreInit,null,[{key:"is",get:function get(){return"my-firestoreinit"}},{key:"properties",get:function get(){return{prop1:{type:String,value:"firestore-init"},dataupdatetoggle:{type:Boolean,value:!1,notify:!0},firestoreconfig:{type:Object,value:"null"},firestorecollectionhndl:{type:Object,value:"null",notify:!0},firestorelistsize:{type:Number,value:0,notify:!0},firestoredataobject:{type:Object,value:"null",notify:!0},firestoreerror:{type:String,value:"null",notify:!0}}}},{key:"observers",get:function get(){return["configFirestore(firestoreconfig.*)"]}}]);function MyFirestoreInit(){var _this;babelHelpers.classCallCheck(this,MyFirestoreInit);_this=babelHelpers.possibleConstructorReturn(this,(MyFirestoreInit.__proto__||Object.getPrototypeOf(MyFirestoreInit)).call(this));_this._observerinit={configFirestore:"none"};return _this}babelHelpers.createClass(MyFirestoreInit,[{key:"ready",value:function ready(){babelHelpers.get(MyFirestoreInit.prototype.__proto__||Object.getPrototypeOf(MyFirestoreInit.prototype),"ready",this).call(this)}},{key:"configFirestore",value:function configFirestore(){console.log("configFirestore Invoked***");if("null"===this.firestoreconfig.collection)return;this.initfirestore(this.firestoreconfig.collection);if(0<=this.firestorelistsize)this.getFirestoreListSize();else{readlistsize=0;this.getFirestoreData()}}},{key:"initfirestore",value:function initfirestore(collection){if(0===myglobal.firestorehandle){myglobal.firestorehandle=firebase.firestore()}this.firestorecollectionhndl=myglobal.firestorehandle.collection(collection);console.log("Got connection handle for collection"+collection+"Handle"+this.firestorecollectionhndl)}},{key:"getFirestoreListSize",value:function getFirestoreListSize(){myglobal.firestorehandle.collection(this.firestoreconfig.collection).orderBy(this.firestoreconfig.orderby,"desc").limit(1).onSnapshot(function(querySnapshot){querySnapshot.forEach(function(doc){console.log(" List Size: "+doc.get("sequence"));this.firestorelistsize=doc.get("sequence");this.dataupdatetoggle=!this.dataupdatetoggle}.bind(this))}.bind(this))}},{key:"getFirestoreData",value:function getFirestoreData(){myglobal.firestorehandle.collection(this.firestoreconfig.collection).orderBy(this.firestoreconfig.orderby,"desc").limit(10).onSnapshot(function(snapshot){console.log("Reset Read list Size");readlistsize=0;snapshot.forEach(function(doc){if(0===readlistsize){console.log("Read the sequence number to get size for the 1st time");this.firestorelistsize=doc.get("sequence");readlistsize=1}console.log(doc.id," => ",doc.data());this.firestoredataobject=doc}.bind(this))}.bind(this))}}]);return MyFirestoreInit}(Polymer.Element);window.customElements.define(MyFirestoreInit.is,MyFirestoreInit);</script></dom-module></body></html>